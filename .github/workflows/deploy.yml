# name: Flask App CI

# on:
#   push:
#     branches: [main, develop]
#   pull_request:
#     branches: [main]

# jobs:
#   lint:
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v4
#       - uses: actions/setup-python@v5
#         with:
#           python-version: "3.12"
#           cache: "pip"
#       - run: pip install ruff
#       - run: ruff check .
#       - run: ruff format --check .

#   test:
#     runs-on: ubuntu-latest
#     needs: lint

#     services:
#       postgres:
#         image: postgres:16
#         env:
#           POSTGRES_USER: shyam
#           POSTGRES_PASSWORD: shyam
#           POSTGRES_DB: flask_structure_test
#         ports:
#           - 5432:5432
#         options: >-
#           --health-cmd pg_isready
#           --health-interval 10s
#           --health-timeout 5s
#           --health-retries 5

#       redis:
#         image: redis:7
#         ports:
#           - 6379:6379
#         options: >-
#           --health-cmd "redis-cli ping"
#           --health-interval 10s
#           --health-timeout 5s
#           --health-retries 5

#     env:
#       DATABASE_URL: postgresql://shyam:shyam@localhost:5432/flask_structure_test
#       SECRET_KEY: ci-secret-key
#       FLASK_ENV: testing

#     steps:
#       - name: Checkout code
#         uses: actions/checkout@v4

#       - name: Set up Python
#         uses: actions/setup-python@v5
#         with:
#           python-version: "3.12"
#           cache: "pip"

#       - name: Install dependencies
#         run: |
#           python -m pip install --upgrade pip
#           pip install -r requirements.txt

#       - name: Run tests
#         run: pytest tests/ --cov=app --cov-report=term-missing